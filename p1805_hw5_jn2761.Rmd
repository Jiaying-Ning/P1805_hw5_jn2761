---
title: "P1805_hw5_jn2761"
author: "jiaying Ning"
date: "11/14/2020"
output: html_document
---


```{r setup, include=FALSE}
#loading package
library(tidyverse)
library(readxl)
library(janitor)
library(dplyr)
library(ggridges)


knitr::opts_chunk$set(
  fig.width = 6,
    fig.asp = .6,
  out.width = "90%"

)

theme_set(theme_minimal()+theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_color_discrete = scale_color_viridis_d
scale_fill_discrete =scale_fill_viridis_d
```

```{r}
library(purrr)
```


## problem 2


```{r, error = TRUE}
df = 
  tibble(
    path = list.files("data"),
  ) %>% 
  mutate(
    path = str_c("data/", path),
    data = map(path,read.csv)) %>%
  unnest() %>% 
   mutate(path=gsub("data/","",path),
          path=gsub(".csv","",path)) %>%
   separate(path, c("control_arm","subject_id"), sep = "([_])") %>%
  relocate(subject_id,control_arm) %>%
   pivot_longer(
    week_1:week_8,
    names_to = "week", 
    names_prefix = "week_",
    values_to = "observation")


```


```{r}
df %>%
  filter(control_arm =="con") 
```
```{r}
df %>%
  group_by(subject_id)%>%
  ggplot(aes(x=week,y=observation,group=subject_id,color=subject_id))+
  geom_line() +
  stat_smooth(aes(group = 1),method = "lm", se = FALSE)+
  facet_grid(. ~ control_arm)
```
Overall, observation value seems to be higher as time pass by for the experimental group, and there seems to no correlation between time and observations for the control group.


